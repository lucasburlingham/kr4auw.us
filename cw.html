<!DOCTYPE html>
<html>
	<head>
		<title>CW</title>
	</head>
	
	<body>
		<h1 style="text-align: center;">Start typing to hear what's typed.</h1>
		<div id="inputted"></div>

		<h4 style="margin-top: 20em; margin-left: auto; text-align: center;">Settings</h4>
		<div id="settings" style="text-align: center;">
			<!-- Slider input for frequency -->
			<label for="frequency">Frequency (200hz to 1000hz): <span id="freq_value"></span></label>
			<br>
			<input type="range" id="frequency" min="200" max="1000" value="550">
			<br>
			<!-- Slider input for WPM -->
			<label for="wpm">WPM (5 to 40): <span id="wpm_value"></span></label>
			<br>
			<!-- impliment this in the queue system timeout -->
			<input type="range" id="wpm" min="5" max="40" value="15" disabled>
			<br>
			<button id="save">Save</button>
			<button id="reset">Reset to defaults</button>
		</div>
		<script>
			// Set the default values for the sliders
			document.getElementById("freq_value").innerHTML = document.getElementById("frequency").value;
			document.getElementById("wpm_value").innerHTML = document.getElementById("wpm").value;
			// Update the slider values when they are changed
			document.getElementById("frequency").oninput = function() {
				document.getElementById("freq_value").innerHTML = this.value;
			}
			document.getElementById("wpm").oninput = function() {
				document.getElementById("wpm_value").innerHTML = this.value;
			}

			// Save the settings in localStorage
			document.getElementById("save").onclick = function() {
				localStorage.setItem("frequency", document.getElementById("frequency").value);
				localStorage.setItem("wpm", document.getElementById("wpm").value);
			}

			window.onload = function() {
				// Set default values for the sliders if they are not already set in localStorage
				if (localStorage.getItem("frequency") == null) {
					localStorage.setItem("frequency", document.getElementById("frequency").value);
				}
				if (localStorage.getItem("wpm") == null) {
					localStorage.setItem("wpm", document.getElementById("wpm").value);
				}

				// Set the sliders to the values in localStorage
				document.getElementById("frequency").value = localStorage.getItem("frequency");
				document.getElementById("wpm").value = localStorage.getItem("wpm");
				document.getElementById("freq_value").innerHTML = localStorage.getItem("frequency");
				document.getElementById("wpm_value").innerHTML = localStorage.getItem("wpm");

				// Output to the console the values in localStorage
				// console.log(localStorage.getItem("frequency"));
				// console.log(localStorage.getItem("wpm"));

			};

			// Reset the sliders to their default values and clear localStorage
			document.getElementById("reset").onclick = function() {
				localStorage.clear();
				document.getElementById("frequency").value = 550;
				document.getElementById("wpm").value = 15;
				document.getElementById("freq_value").innerHTML = 550;
				document.getElementById("wpm_value").innerHTML = 15;

				// Send values to localStorage
				localStorage.setItem("frequency", document.getElementById("frequency").value);
				localStorage.setItem("wpm", document.getElementById("wpm").value);
			}

			// Play the tone for 1 second or until the slider is changed again 
			// (whichever comes first)
			document.getElementById("frequency").oninput = function() {
				var freq = document.getElementById("frequency").value;
				var context = new AudioContext();
				var oscillator = context.createOscillator();
				oscillator.type = "sine";
				oscillator.frequency.value = freq;
				oscillator.connect(context.destination);
				oscillator.start();
				setTimeout(function() {
					oscillator.stop();
					context.close();
				}, 100);
			}
			
		</script>
		<script src="cw.js"></script>
	</body>
</html>